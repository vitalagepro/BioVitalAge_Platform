<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cartella Paziente, {{ persona.name }}</title>

    {% load static %}
    <link rel="stylesheet" href="{% static 'includes/homePage.css' %}">
    <link rel="stylesheet" href="{% static 'includes/cartellaPaziente.css' %}">

    <!-- Bootstrap import -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Import  -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <header>
        <div class="nav-bar-user-modal" id="userModal">
            <button id="nav-bar-user-modal-btn" class="nav-bar-user-modal-btn">log out</button>
        </div>

        <nav class="col-md-12 d-flex justify-content-between align-items-center nav-bar ">
            <div class="col-md-2 d-flex jus nav-bar-logo">
                <img src="{% static 'includes/icone/Logo.png' %}" alt="">
            </div>
            <div class="col-md-8 nav-bar-linkage">
                <a href="{% url 'HomePage' %}">HomePage</a>
                <a href="{% url 'Calcolatore' %}">Calcolatore Età Biologica</a>
                <a href="{% url 'Risultati' %}" id="active">Ricerca Pazienti</a>
            </div>

            <div class="col-md-2 nav-bar-user">
                <h3>Demo User</h3>
                <div class="img-container-user-nav-bar">
                    <img id="userImg" src="{% static 'includes/icone/username.png' %}" alt="user">
                </div>
            </div>
        </nav>
    </header>

    <main>
        <div class="main-title-nav">
            <div class="back-tittle">
                <a id="back" href="{% url 'Risultati' %}"><img src="{% static 'includes/icone/arrowBack.png' %}" alt=""></a>
                <h2 class="main-welcome-title">Cartella Paziente, {{ persona.name }} {{ persona.surname }}</h2>
            </div>
           
            <div class="main-menu-trace">
                <img src="{% static 'includes/icone/homePage.png' %}" alt="">
                <p>»</p>
                <p>Cartella Paziente</p>
            </div>
        </div>

        <div class="container-datiPersonali containerStyle">
            <div class="card card1" id="card-style">
                <div class="header-card">
                    <h2>Personal Information</h2>
                    <div class="button-grid">
                        <a href="#"><img src="{% static 'includes/icone/referto.png' %}" alt=""></a>
                        <a href="#"><img src="{% static 'includes/icone/rotella.png' %}" alt=""></a>
                    </div>
                </div>
                <div class="card-body">
                    <p><strong>Nome:</strong> &nbsp; {{ persona.name }}</p>
                    <p><strong>Cognome:</strong> &nbsp;  {{ persona.surname }}</p>
                    <p><strong>Data di Nascita:</strong> &nbsp;  {{ persona.dob }} </p>
                    <p><strong>Codice Fiscale:</strong> &nbsp;  {{ persona.codice_fiscale }}</p>
                    <p><strong>Luogo di Nascita:</strong> &nbsp; {{ persona.place_of_birth }}</p>
                    <p><strong>Età Cronologica:</strong> &nbsp; {{ dati_estesi_ultimo_referto.chronological_age }}</p>
                </div>
            </div>
        </div>

        <div class="dashboard">
        
            <div class="card-graphic"  id="card-style">
                <div class="icon">
                    <img src="{% static 'includes/icone/pillola.png' %}" alt="BP Levels Icon">
                </div>
                <h3>BP Levels</h3>
                <p>Recent five visits</p>
                <canvas id="chart1"></canvas>
                <div class="data">
                    <table>
                        <tr><td>24/04/2024</td><td>140</td></tr>
                        <tr><td>16/04/2024</td><td>190</td></tr>
                        <tr><td>10/04/2024</td><td>230</td></tr>
                    </table>
                </div>
            </div>
         
            <div class="card-graphic"  id="card-style">
                <div class="icon">
                    <img src="{% static 'includes/icone/sugar.png' %}" alt="Sugar Levels Icon">
                </div>
                <h3>Sugar Levels</h3>
                <p>Recent five visits</p>
                <canvas id="chart2"></canvas>
                <div class="data">
                    <table>
                        <tr><td>24/04/2024</td><td>140</td></tr>
                        <tr><td>16/04/2024</td><td>190</td></tr>
                        <tr><td>10/04/2024</td><td>230</td></tr>
                    </table>
                </div>
            </div>
      
            <div class="card-graphic"  id="card-style">
                <div class="icon">
                    <img src="{% static 'includes/icone/heart.png' %}" alt="Heart Rate Icon">
                </div>
                <h3>Heart Rate</h3>
                <p>Recent five visits</p>
                <canvas id="chart3"></canvas>
                <div class="data">
                    <table>
                        <tr><td>24/04/2024</td><td>110</td></tr>
                        <tr><td>16/04/2024</td><td>120</td></tr>
                        <tr><td>10/04/2024</td><td>100</td></tr>
                    </table>
                </div>
            </div>
      
            <div class="card-graphic"  id="card-style">
                <div class="icon">
                    <img src="{% static 'includes/icone/provetta.png' %}" alt="Cholesterol Icon">
                </div>
                <h3>Cholesterol</h3>
                <p>Recent five visits</p>
                <canvas id="chart4"></canvas>
                <div class="data">
                    <table>
                        <tr><td>24/04/2024</td><td>180</td></tr>
                        <tr><td>16/04/2024</td><td>220</td></tr>
                        <tr><td>10/04/2024</td><td>230</td></tr>
                    </table>
                </div>
            </div>
        </div>

        <div class="container-indicatori containerStyle">
            <div class="card card4" id="card-style">
                <h2 class="section-tittle">Latest Organ Health Scores</p>
               
                <div class="score-clock-graph">
                    
                    <div class="clock" id="kidneyClock">
                        <div class="inner"></div>
                        <div class="percentage" id="kidneyPercentage"></div>
                      
                        <p id="clock-description">Kidney Health</p>
                    </div>
                
                    <div class="clock" id="lipidClock">
                        <div class="inner"></div>
                        <div class="percentage" id="lipidPercentage"></div>
                      
                        <p id="clock-description">Lipid Health</p>
                    </div>
                
                    <div class="clock" id="liverClock">
                        <div class="inner"></div>
                        <div class="percentage" id="liverPercentage"></div>
                       
                        <p id="clock-description">Liver Health</p>
                    </div>
                
                    <div class="clock" id="glucoseClock">
                        <div class="inner"></div>
                        <div class="percentage" id="glucosePercentage"></div>
                       
                        <p id="clock-description">Glucose Health</p>
                    </div>
                
                </div>
            </div>

            <div class="card card5">
                <h2>Analisi Report</h2>

                <div class="blood-container">
                    <h5>Blood report</h5>
                    <div class="">
                        <p><strong>Ultima analisi:</strong>  &nbsp; 15/09/2000 </p>
                        <a href="#"><img src="{% static 'includes/icone/referto.png' %}" alt=""></a>
                    </div>
                </div>

                <div class="exam-container">
                    <h5>Exam</h5>
                    <div class="">
                        <p><strong>Ultima analisi:</strong>  &nbsp; 15/09/2000 </p>
                        <a href="#"><img src="{% static 'includes/icone/referto.png' %}" alt=""></a>
                    </div>
                </div>

                <button id="button-fix">Aggiorna analisi</button>
            </div>
        </div>

        <div class="dashboard2">
      
            <div class="cardChart"  id="card-style">
                <h2>Numero Controlli</h2>
                <canvas id="chartDash2_1"></canvas>
            </div>

            <div class="cardChart"  id="card-style">
                <h2>Numero Esami</h2>
                <canvas id="chartDash_2"></canvas>
            </div>
        </div>

        <div class="contenitore-tabella">
            <div class="recent-patients" id="card-style">
                <h2>Ultimi 5 Referti</h2>
                <div class="risultati-ricerca">
                    <div class="table-placeholder">
                        <p class="cella">Chronological Age</p>
                        <p class="cella">Biological Age</p>
                        <p class="cella">Valore Referto</p>
                        <p class="cella">Data Referto</p>
                        <p class="cella">Mostra Referto</p>
                        <p class="cella">Scarica Referto</p>
                    </div>
                    {% for referto in referti_recenti %}
                <div class="col-md-12 content-table">
                    <div class="cella">
                        <!-- Cerca i dati estesi per il referto corrente -->
                        {% for dato in dati_estesi %}
                            {% if dato.referto.id == referto.id %}
                                <p>{{ dato.chronological_age }}</p>
                            {% endif %}
                        {% endfor %}
                    </div>
                    <div class="cella">
                        {% for dato in dati_estesi %}
                            {% if dato.referto.id == referto.id %}
                                <p>{{ dato.biological_age }}</p>
                            {% endif %}
                        {% endfor %}
                    </div>
                    <div class="cella">
                        <p>{{ referto.descrizione }}</p>
                    </div>
                    <div class="cella">
                        <p>{{ referto.data_referto|date:"d/m/Y" }}</p>
                    </div>
                    <div class="cella">
                        <a href="{% url 'persona_detail' persona.id %}">
                            <img src="{% static 'includes/icone/referto.png' %}" alt="" />
                        </a>
                    </div>
                    <div class="cella">
                        <a href="{% url 'cartella_paziente' persona.id %}">
                            <img src="{% static 'includes/icone/download.png' %}" alt="" />
                        </a>
                    </div>
                </div>
                {% empty %}
                <p class="text-center">No recent reports found.</p>
                {% endfor %}

                </div>
            </div>
        </div>  

        
        <div class="conteiner-operation">
            <div class="card7" id="card-fix">
                <div class="backdrop"></div>
                <h2>Guarda tutti i Referti</h2>
                <button class="button-style">Clicca qui</button>
            </div>
            <div class="card8">
                <div class="backdrop"></div>
                <h2>Calcola L'età Biologica</h2>
                <button class="button-style">Clicca qui</button>
            </div>
        </div>

        
    </main>

    
    <!-- Import Js -->
    <script src="{% static 'includes/js/cartellaPaziente.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
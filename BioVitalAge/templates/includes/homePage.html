<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href='../../../../static/includes/icone/favicon.png' type="image/x-icon">
    <title>BioVitalAge - HomePage</title>

    {% load static %}
    <link rel="stylesheet" href="{% static 'includes/homePage.css' %}" />

    <!-- Bootstrap import -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Font Import  -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap"
      rel="stylesheet"
    />

    <!-- Js Import -->
    <script src="{% static 'includes/js/HomePage.js' %}" defer></script>

    <!-- Chart Import -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.0.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <div id="sidebar" class="bg-sidebar hidden"></div>
    <header>
      <nav
        class="col-md-12 d-flex justify-content-between align-items-center nav-bar"
      >
        <div class="col-md-2 d-flex jus nav-bar-logo">
          <img src="{% static 'includes/icone/Logo.png' %}" alt="logo_img" title="BioVitalAge®"/>
        </div>
        <div class="col-md-8 nav-bar-linkage">
          <a href="{% url 'HomePage' %}" id="active">HomePage</a>
          <a href="{% url 'inserisci_paziente' %}">Inserisci Paziente</a>
          <a href="{% url 'Calcolatore' %}">BioVitalAge Clock</a>
          <a href="{% url 'Risultati' %}">Ricerca Pazienti</a>
        </div>

        <div class="col-md-2 nav-bar-user">
          <h3>Demo User</h3>

          <div class="img-container-user-nav-bar">
            <img
              id="userImg"
              src="{% static 'includes/icone/username.png' %}"
              alt="user"
            />
          </div>
          <div class="nav-bar-user-modal" id="userModal">
            <button id="nav-bar-user-modal-btn" class="nav-bar-user-modal-btn">
              log out
            </button>
          </div>
        </div>
      </nav>
    </header>

    <main>
      <div class="main-title-nav">
        <!-- SIDEBAR LATERAL -->
        <div id="sidebar" class="sidebar hidden">
          <div class="sidebar-header">
            <h3 id="sidebar-title">Sezione</h3>
            <button id="closeSidebar">✖</button>
          </div>
          <div id="sidebar-content"></div>
        </div>

        <div class="linkage-container">
          <a
            href="#"
            title="Notifiche"
            class="sidebar-trigger"
            data-section="Notifiche"
          >
            <img
              src="{% static 'includes/icone/notifica.png' %}"
              alt="icon-notify"
            />
          </a>
          <a
            href="#"
            title="Email"
            class="sidebar-trigger"
            data-section="Email"
          >
            <img
              src="{% static 'includes/icone/email.png' %}"
              alt="icon-email"
            />
          </a>
          <a
            href="#"
            title="Update"
            class="sidebar-trigger"
            data-section="Update"
          >
            <img
              src="{% static 'includes/icone/update.png' %}"
              alt="icon-update"
            />
          </a>
        </div>

        <div class="main-menu-trace" title="Home Page">
          <a href="{% url 'HomePage' %}">
            <img src="{% static 'includes/icone/homePage.png' %}" alt="" />
          </a>
          <p>»</p>
          <p>Home Page</p>
        </div>
      </div>

      <section class="banner-section">
        <div class="banner">
          <div class="banner-info">
            <h3>Good Morning</h3>
            <h2 class="main-welcome-title" id="nameUser">Dott. Rossi</h2>
            <div class="box-icons">
              <div class="box-info">
                <div class="icon-container">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <path
                      d="M8 3V5H6V9C6 11.2091 7.79086 13 10 13C12.2091 13 14 11.2091 14 9V5H12V3H15C15.5523 3 16 3.44772 16 4V9C16 11.9727 13.8381 14.4405 11.0008 14.9169L11 16.5C11 18.433 12.567 20 14.5 20C15.9973 20 17.275 19.0598 17.7749 17.7375C16.7283 17.27 16 16.2201 16 15C16 13.3431 17.3431 12 19 12C20.6569 12 22 13.3431 22 15C22 16.3711 21.0802 17.5274 19.824 17.8854C19.2102 20.252 17.0592 22 14.5 22C11.4624 22 9 19.5376 9 16.5L9.00019 14.9171C6.16238 14.4411 4 11.9731 4 9V4C4 3.44772 4.44772 3 5 3H8ZM19 14C18.4477 14 18 14.4477 18 15C18 15.5523 18.4477 16 19 16C19.5523 16 20 15.5523 20 15C20 14.4477 19.5523 14 19 14Z"
                    ></path>
                  </svg>
                </div>
                <div>
                  <h1>86</h1>
                  <span>Pazienti Visitati</span>
                </div>
              </div>
              <div class="box-info">
                <div class="icon-container">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <path
                      d="M10 2C10.5523 2 11 2.44772 11 3V7C11 7.55228 10.5523 8 10 8H8V10H13V9C13 8.44772 13.4477 8 14 8H20C20.5523 8 21 8.44772 21 9V13C21 13.5523 20.5523 14 20 14H14C13.4477 14 13 13.5523 13 13V12H8V18H13V17C13 16.4477 13.4477 16 14 16H20C20.5523 16 21 16.4477 21 17V21C21 21.5523 20.5523 22 20 22H14C13.4477 22 13 21.5523 13 21V20H7C6.44772 20 6 19.5523 6 19V8H4C3.44772 8 3 7.55228 3 7V3C3 2.44772 3.44772 2 4 2H10ZM19 18H15V20H19V18ZM19 10H15V12H19V10ZM9 4H5V6H9V4Z"
                    ></path>
                  </svg>
                </div>
                <div>
                  <h1>23</h1>
                  <span>Calcolo Età Biologica</span>
                </div>
              </div>
            </div>
          </div>
          <!-- Card for Appointment Calendar -->
          <div class="appointment-card">
            <div class="card">
              <h3>Calendario Appuntamenti</h3>
              <p>Visualizza e gestisci gli appuntamenti.</p>
              <button onclick="window.location.href='#'" class="button-style">Calendar</button>
            </div>
          </div>
        </div>
      
      </section>
      
    
   
      <div class="recent-patients">
          <h2>Ultimi 5 Pazienti Visitati</h2>
          <div class="risultati-ricerca">
            <div class="table-placeholder">
              <p class="cella">Name</p>
              <p class="cella">Surname</p>
              <p class="cella">Date of Birth</p>
              <p class="cella">Codice Fiscale</p>
              <p class="cella">Place of Birth</p>
              <p class="cella">Chronological Age</p>
              <p class="cella">Biological Age</p>
              <p class="cella">Ultimo Referto</p>
              <p class="cella">Cartella Paziente</p>
            </div>
            <div class="col-md-12 content-table">
              {% for persona in persone %}
              <div class="riga d-flex justify-content-between align-items-center">
                <div class="cella">
                  <p>{{ persona.name }}</p>
                </div>
                <div class="cella">
                  <p>{{ persona.surname }}</p>
                </div>
                <div class="cella">
                  <p>{{ persona.dob|date:"d/m/Y" }}</p>
                </div>
                <div class="cella">
                  <p>{{ persona.codice_fiscale }}</p>
                </div>
                <div class="cella">
                  <p>{{ persona.place_of_birth }}</p>
                </div>
                <div class="cella">
                  <!-- Associa il dato corretto al paziente -->
                  {% for dato in datiEstesi %}
                    {% if dato.referto.paziente.id == persona.id %}
                      <p>{{ dato.chronological_age }}</p>
                    {% endif %}
                  {% endfor %}
                </div>
                <div class="cella">
                  <!-- Associa il dato corretto al paziente -->
                  {% for dato in datiEstesi %}
                    {% if dato.referto.paziente.id == persona.id %}
                      <p>{{ dato.biological_age }}</p>
                    {% endif %}
                  {% endfor %}
                </div>
                <div class="cella">
                  <a href="{% url 'persona_detail' persona.id %}">
                    <img src="{% static 'includes/icone/referto.png' %}" alt="" />
                  </a>
                </div>
                <div class="cella">
                  <a href="{% url 'cartella_paziente' persona.id %}">
                    <img src="{% static 'includes/icone/cartella.png' %}" alt="" />
                  </a>
                </div>
                
              </div>
              {% empty %}
              <p class="text-center">No results found</p>
              {% endfor %}
              
            </div>
          </div>
      </div>   
   

      <div class="contenitore-inserisci-paziente">
        <div class="banner-paziente">
          <div class="banner-backdrop">
            <img src="{% static 'includes/images/banner-home.png' %}" alt="">
          </div>
          <div class="banner-content">
            <h3>Card Vuota</h3>
            <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit.</p>
            <button class="button-style" onclick="window.location.href='{% url 'inserisci_paziente' %}'">Aggiungi</button>
          </div>
        </div>
        <div class="banner-paziente">
          <div class="banner-backdrop">
            <img src="{% static 'includes/images/banner-home.png' %}" alt="">
          </div>
          <div class="banner-content">
            <h3>Inserisci un paziente</h3>
            <p>Sezione di creazione paziente mediante dati base</p>
            <p class="list-info"><span>[</span> Dati Anagrafici, Dati Antromotreci,</p>
            <p class="list-info"> Abdominal girth, Life style <span>]</span></p>
            <button class="button-style" onclick="window.location.href='{% url 'inserisci_paziente' %}'">Aggiungi</button>
          </div>
        </div>
      </div>


      <div class="cards">
        <div class="card" id="card-style">
          <h2>Totale Pazienti Visitati</h2>
          <p>150</p>
          <button onclick="goToPatientsPage()">Vedi Tutti</button>
        </div>
        <div class="card" id="card-style">
          <h2>Calcoli Età Biologica</h2>
          <p>120</p>
          <button onclick="goToRefertiPage()">Referti</button>
        </div>
        <div class="card" id="card-style">
          <h2>Media Età Pazienti</h2>
          <p>52 anni</p>
        </div>
      </div>

     

      <div class="content">
        <div class="charts-section">
          <div class="chart-container">
            <h3>Andamento Inserimento Pazienti</h3>
            <canvas id="patientsChart"></canvas>
          </div>
          <div class="chart-container">
            <h3>Pazienti Mensili</h3>
            <canvas id="monthlyPatientsChart"></canvas>
            <div id="monthlyTooltip" class="chartjs-tooltip"></div>
          </div>
        </div>

        <div class="first-cards">
          <div class="card bg-biological">
            <div>
              <h2>Età Biologica</h2>
              <button onclick="goToPatientsPage()">Referti</button>
            </div>
            <div>
              <img
                src="../../static/includes/images/biological-item-banner.webp"
                width="100px"
                height="100px"
                alt="biological-item-banner"
              />
            </div>
          </div>
          <div class="card bg-biological">
            <div>
              <h2>Ricerca Pazienti</h2>
              <button onclick="goToPatientsPage()">Vedi Tutti</button>
            </div>
            <div>
              <img
                src="../../static/includes/images/search-patients-item.webp"
                width="100px"
                height="100px"
                alt="serach-item-patients"
              />
            </div>
          </div>
        </div>
      </div>
        
      

    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>

{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <!-- Favicon -->
    <link rel="shortcut icon" href="{% static 'includes/icone/favicon.png' %}" type="image/x-icon" />
    
    <title>BioVitalAge - Dati Base & Stile di Vita</title>

    <!-- Css Import -->
    <link rel="stylesheet" href="{% static 'includes/css/Componenti.css' %}">
    <link rel="stylesheet" href="{% static 'includes/css/dati_base.css' %}" />

    <!-- Bootstrap import -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Font Import  -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet"/>

    <!-- JS import -->
    <script src="{% static 'includes/js/dati_base.js' %}" defer></script>

  </head>
  <body>

    <!-- Loader -->
    {% include 'components/loader.html' %}

    <!-- NAVBAR -->
    {% include 'components/navBar.html' %}

    <main>
      <div class="main-title-nav">
        <div class="back-tittle">
          <a id="back" href="{% url 'cartella_paziente' persona.id %}"><img src="{% static 'includes/icone/arrowBack.png' %}" alt="back_ico" title="Back to folder"></a>
          <h2 class="main-welcome-title">Dati Base & Stile di Vita, {{ persona.name }} {{ persona.surname }}</h2>
        </div>
        <div class="main-menu-trace">
          <a href="{% url 'HomePage' %}">
            <img src="{% static 'includes/icone/homePage.png' %}" alt="Home Page" title="Home Page"/>
          </a>
          <span>»</span>
          <span>Cartella Paziente</span>
          <span>»</span>
          <span>Dati Base & Stile di Vita</span>
        </div>
      </div>

      <section class="container_data anagraphic_data">
        <h3>Dati Anagrafici</h3>
        <div class="container_box">
          <div class="info_container">

              <div class="field">
                <p>Nome:&nbsp;</p>
                <p>{{ persona.name }}</p>
              </div>

              <div class="field">
                <p>Cognome:&nbsp;</p>
                <p>{{ persona.surname }}</p>
              </div>

              <div class="field">
                <p>Codice Fiscale :&nbsp;</p>
                <p>{{ persona.codice_fiscale }}</p>
              </div>

              <div class="field">
                <p>Città:&nbsp;</p>
                <p>{{ persona.place_of_birth }}</p>
              </div>

              <div class="field">
                <p>Età:&nbsp;</p>
                <p>{{ persona.chronological_age }}</p>
              </div>

              <div class="field">
                <p>Data di nascita:&nbsp;</p>
                <p>{{ persona.dob }}</p>
              </div>
      
              <div class="field">
                <p>Telefono:&nbsp;</p>
                <p>{{ persona.phone }}</p>
              </div>

              <div class="field">
                <p>Dottore Associato:&nbsp;</p>
                <p>{{ persona.associate_staff }}</p>
              </div>

          </div>
        </div>
      </section>

      <section class="container_data table_data">
        <h3 style="margin-bottom: -20px;">Dati Base</h3>

        <form id="datiBaseForm" action="" method="POST">
          {% csrf_token %}
          <div class="table-title-tools">
            <p class="table-title">Dati antropometrici</p>
            
            <!-- Menu Tools con effetto translate e opacity -->
             <div class="container-menu">
               <div class="tools-menu-button" id="menu-1">
                   <button class="tools-table" type="button" onclick="closeMenuTools('menu-1')" class="close-menu" style="margin-right: 20px;">
                       <img src="{% static 'includes/icone/chiudi.png' %}" alt="Chiudi" title="Chiudi">
                   </button>
                   <button type="button" class="tools-table"><img src="{% static 'includes/icone/aggiungi.png' %}" alt="Aggiungi" title="Aggiungi"></button>
                   <button type="button" class="tools-table"><img src="{% static 'includes/icone/modifica.png' %}" alt="Modifica" title="Modifica"></button>
                   <button type="button" class="tools-table"><img src="{% static 'includes/icone/cestino.png' %}" alt="Cestino" title="Cestino"></button>
               </div>
           
               <!-- Bottone per aprire il menu con animazione -->
               <button title="Apri Menu" type="button" class="tools-table" class="open-menu" onclick="this.title === 'Salva le modifiche' ? closeMenuTools('menu-1') : openMenuTools('menu-1')">
                   <img src="{% static 'includes/icone/modify.png' %}" alt="Apri Menu">
               </button>
             </div>
          </div>
      
          <div class="table-container">
              <div class="table-header">
                  <p>Altezza</p>
                  <p>Peso</p>
                  <p>BMI</p>
                  <p>Data di rilevamento del BMI</p>
              </div>
      
              <div class="table-content">
                <div class="riga-container">
                  <p><input name="height" type="text" value="{{ persona.height }}" disabled></p>
                  <p><input name="weight" type="text" value="{{ persona.weight }}" disabled></p>
                  <p><input name="bmi" type="text" value="{{ persona.bmi }}" disabled></p>
                  <p><input name="bmi_detection_date" type="date" value="{{ persona.bmi_detection_date|date:'Y-m-d' }}" disabled></p>
                  <input type="hidden" name="form_id" value="datiBaseForm1">
                </div>
              </div>
          </div> 
        </form>
     
        <form id="datiBaseForm1" method="POST">
          {% csrf_token %}
          <div class="table-title-tools">
            <p class="table-title">Circonferenza addominale</p>
            <div class="container-menu">
              <div class="tools-menu-button" id="menu-2">
                <button type="button" class="tools-table" type="button" onclick="closeMenuTools('menu-2')" style="margin-right: 20px;"><img src="{% static 'includes/icone/chiudi.png' %}" alt="Chiudi" title="Chiudi"></button>
                <button type="button" class="tools-table"><img src="{% static 'includes/icone/aggiungi.png' %}" alt="Aggiungi" title="Aggiungi"></button>
                <button type="button" class="tools-table"><img src="{% static 'includes/icone/modifica.png' %}" alt="Modifica" title="Modifica"></button>
                <button type="button" class="tools-table"><img src="{% static 'includes/icone/cestino.png' %}" alt="Cestino" title="Cestino"></button>
              </div>
  
              <button title="Apri Menu" type="button" class="tools-table" onclick="this.title === 'Salva le modifiche' ? closeMenuTools('menu-2') : openMenuTools('menu-2')"><img src="{% static 'includes/icone/modify.png' %}" alt="Apri Menu"></button>
            </div>
          </div>

            <div class="table-container">
              <div class="table-header">
                <p>Circonferenza</p>
                <p>Data di misurazione</p>
                <p>Note</p>
              </div>
            
              <div class="table-content">
                <div class="riga-container">
                  <p> <input name="girth_value" type="text" value="{{ persona.girth_value }}" disabled> </p>
                  <p> <input name="girth_date" type="date" value="{{ persona.girth_date|date:'Y-m-d' }}" disabled> </p>
                  <p> <input name="girth_notes" type="text" value="{{ persona.girth_notes }}" disabled> </p>
                  <input type="hidden" name="form_id" value="datiBaseForm2">
                </div>
            
              </div>
            </div>
        </form>
        <h3 style="margin-top: 20px; margin-bottom: -20px;">Stile di vita</h3>
  
        <form id="datiBaseForm2" method="POST">
          {% csrf_token %} 
            <div class="table-title-tools">
              <p class="table-title">Alcohol</p>
              <div class="container-menu">
                <div class="tools-menu-button" id="menu-3">
                  <button type="button" class="tools-table" type="button" onclick="closeMenuTools('menu-3')" style="margin-right: 20px;"><img src="{% static 'includes/icone/chiudi.png' %}" alt="Chiudi" title="Chiudi"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/aggiungi.png' %}" alt="Aggiungi" title="Aggiungi"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/modifica.png' %}" alt="Modifica" title="Modifica"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/cestino.png' %}" alt="Cestino" title="Cestino"></button>
                </div>
  
                <button title="Apri Menu" type="button" class="tools-table" onclick="this.title === 'Salva le modifiche' ? closeMenuTools('menu-3') : openMenuTools('menu-3')"><img src="{% static 'includes/icone/modify.png' %}" alt="Apri Menu"></button>
              </div>
            </div>
            
            <div class="table-container">
              <div class="table-header">
                <p>Quantità di cc al giorno</p>
                <p>Assunzione di alcol</p>
                <p>Data</p>
                <p>Note</p>
              </div>
            
              <div class="table-content">
                <div class="riga-container">
                  <p> <input name="alcol" type="text" value="{{ persona.alcol|default:'N/A' }}" disabled> </p>
                  <p> <input name="alcol_type" type="text" value="{{ persona.alcol_type|default:'N/A' }}" disabled> </p>
                  <p> <input name="data_alcol" type="date" value="{{ persona.data_alcol|date:'Y-m-d'|default:'N/A' }}" disabled> </p>
                  <p> <input name="alcol_frequency" type="text" value="{{ persona.alcol_frequency|default:'N/A' }}" disabled> </p>
                  <input type="hidden" name="form_id" value="datiBaseForm3">
                </div>
              </div>
            </div>
        </form>
   
        <form id="datiBaseForm3" method="POST">
          {% csrf_token %} 
            <div class="table-title-tools">
              <p class="table-title">Fumo</p>
              <div class="container-menu">
                <div class="tools-menu-button" id="menu-4">
                  <button type="button" class="tools-table" type="button" onclick="closeMenuTools('menu-4')" style="margin-right: 20px;"><img src="{% static 'includes/icone/chiudi.png' %}" alt="Chiudi" title="Chiudi"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/aggiungi.png' %}" alt="Aggiungi" title="Aggiungi"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/modifica.png' %}" alt="Modifica" title="Modifica"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/cestino.png' %}" alt="Cestino" title="Cestino"></button>
                </div>
  
                <button title="Apri Menu" type="button" class="tools-table" onclick="this.title === 'Salva le modifiche' ? closeMenuTools('menu-4') : openMenuTools('menu-4')"><img src="{% static 'includes/icone/modify.png' %}" alt="Apri Menu"></button>
              </div>
            </div>
            <div class="table-container">
              <div class="table-header">
                <p>Quantità giornaliera</p>
                <p>Giorni</p>
                <p>Note</p>
              </div>
            
              <div class="table-content">
                <div class="riga-container">
                  <p> <input name="smoke" type="text" value="{{ persona.smoke|default:'N/A' }}" disabled> </p>
                  <p> <input name="smoke_frequency" type="text" value="{{ persona.smoke_frequency|default:'N/A' }}" disabled> </p>
                  <p> <input name="reduced_intake" type="text" value="{{ persona.reduced_intake|default:'N/A' }}" disabled> </p>
                  <input type="hidden" name="form_id" value="datiBaseForm4">
                </div>
              </div>
            </div>
        </form>        
      
        <form id="datiBaseForm4" method="POST">
          {% csrf_token %}
            <div class="table-title-tools">
              <p class="table-title">Sport</p>
              <div class="container-menu">
                <div class="tools-menu-button" id="menu-5">
                  <button type="button" class="tools-table" type="button" onclick="closeMenuTools('menu-5')" style="margin-right: 20px;"><img src="{% static 'includes/icone/chiudi.png' %}" alt="Chiudi" title="Chiudi"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/aggiungi.png' %}" alt="Aggiungi" title="Aggiungi"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/modifica.png' %}" alt="Modifica" title="Modifica"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/cestino.png' %}" alt="Cestino" title="Cestino"></button>
                </div>
  
                <button title="Apri Menu" class="tools-table" type="button" onclick="this.title === 'Salva le modifiche' ? closeMenuTools('menu-5') : openMenuTools('menu-5')"><img src="{% static 'includes/icone/modify.png' %}" alt="Apri Menu"></button>
              </div>
            </div>
            <div class="table-container">
              <div class="table-header">
                <p>Attività Fisica</p>
                <p>Livello</p>
                <p>Frequenza</p>
              </div>
            
              <div class="table-content">
                <div class="riga-container">
                  <p> <input name="sport" type="text" value="{{ persona.sport|default:'N/A' }}" disabled> </p>
                  <p> <input name="sport_livello" type="text" value="{{ persona.sport_livello|default:'N/A' }}" disabled> </p>
                  <p> <input name="sport_frequency" type="text" value="{{ persona.sport_frequency|default:'N/A' }}" disabled> </p>
                  <input type="hidden" name="form_id" value="datiBaseForm5">
                </div>
              </div>
            </div>
        </form>

        <form id="datiBaseForm5" method="POST">
          {% csrf_token %}
            <div class="table-title-tools">
              <p class="table-title">Sedentarietà</p>
              <div class="container-menu">
                <div class="tools-menu-button" id="menu-6">
                  <button type="button" class="tools-table" type="button" onclick="closeMenuTools('menu-6')" style="margin-right: 20px;"><img src="{% static 'includes/icone/chiudi.png' %}" alt="Chiudi" title="Chiudi"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/aggiungi.png' %}" alt="Aggiungi" title="Aggiungi"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/modifica.png' %}" alt="Modifica" title="Modifica"></button>
                  <button type="button" class="tools-table"><img src="{% static 'includes/icone/cestino.png' %}" alt="Cestino" title="Cestino"></button>
                </div>
  
                <button title="Apri Menu" type="button" class="tools-table" title="Apri Menu" onclick="this.title === 'Salva le modifiche' ? closeMenuTools('menu-6') : openMenuTools('menu-6')"><img src="{% static 'includes/icone/modify.png' %}" alt="Apri Menu"></button>
              </div>
            </div>
            <div class="table-container">
              <div class="table-header">
                <p>Attività Sedentaria</p>
                <p>Livello</p>
                <p>Note</p>
              </div>
            
              <div class="table-content">
                <div class="riga-container">
                  <p> <input name="attivita_sedentaria" type="text" value="{{ persona.attivita_sedentaria|default:'N/A' }}" disabled> </p>
                  <p> <input name="livello_sedentarieta" type="text" value="{{ persona.livello_sedentarieta|default:'N/A' }}" disabled> </p>
                  <p> <input name="sedentarieta_nota" type="text" value="{{ persona.sedentarieta_nota|default:'N/A' }}" disabled> </p>
                  <input type="hidden" name="form_id" value="datiBaseForm6">
                </div>
              </div>
            </div>
        </form>
      </section>

      <section class="container_data blood_data">
        
        <div class="container-blood-input">
          <div class="column">
            <div class="container mb-4">
              <h3>Pressione Arteriosa</h3>
              <input type="text" placeholder="Inserisci valori" readonly id="pressure" value="{{ persona.pressure|default:'' }}"
                data-patient-id="{{ persona.id }}" />
            </div>
          
            <div class="container">
              <h3>Frequenza Cardiaca</h3>
              <input type="text" placeholder="Inserisci valori" readonly id="heart_rate" value="{{ persona.heart_rate|default:'' }}"
                data-patient-id="{{ persona.id }}" />
            </div>
          </div>

          <div class="column">
            <div class="container mb-4">
              <h3>Gruppo Sanguigno</h3>
              <input type="text" readonly placeholder="Inserisci valori" id="blood_group" value="{{ persona.blood_group|default:'' }}" data-patient-id="{{ persona.id }}"/>
            </div>
  
            <div class="container">
                <h3>Fattore rh</h3>
                <input type="text" readonly placeholder="Inserisci valori" id="rh" value="{{ persona.rh_factor|default:'' }}" data-patient-id="{{ persona.id }}"/>
            </div>
          </div>

        </div>
        <button class="button" id="btn_blood_group">
          <span class="button__icon-wrapper">
            <svg
            viewBox="0 0 14 15"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="button__icon-svg"
            width="14"
          >
            <path
              d="M7 1V4M7 11V14M1 7H4M10 7H13M3.5 3.5L5 5M9 9L10.5 10.5M3.5 10.5L5 9M9 5L10.5 3.5"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          
          <svg
            viewBox="0 0 14 15"
            fill="none"
            width="14"
            xmlns="http://www.w3.org/2000/svg"
            class="button__icon-svg button__icon-svg--copy"
          >
            <path
              d="M7 1V4M7 11V14M1 7H4M10 7H13M3.5 3.5L5 5M9 9L10.5 10.5M3.5 10.5L5 9M9 5L10.5 3.5"
              stroke="currentColor"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          </span>
          Update
        </button>
      </section>
    </main>

    <script>
      // Aprire il menu con animazione fluida
      function openMenuTools(menuId) {
          const menu = document.getElementById(menuId);
          menu.style.display = 'flex'; 
          setTimeout(() => {
              menu.style.opacity = '1';
              menu.style.transform = 'translateX(0)';
          }, 10); // Ritardo per attivare la transizione dopo il cambio display
      }

      // Chiudere il menu con animazione fluida
      function closeMenuTools(menuId) {
          const menu = document.getElementById(menuId);
          menu.style.opacity = '0';
          menu.style.transform = 'translateX(20px)';
          setTimeout(() => {
              menu.style.display = 'none';
          }, 300); // Attendere il completamento della transizione prima di nascondere
      }
    </script>
  </body>
</html>
